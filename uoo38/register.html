<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>Register</title>
  </head>
  <body>
    <table>
      <tr>
        <td>ID</td>
        <td><input type="text" id="id"></td>
      </tr>

      <tr>
        <td>パスワード</td>
        <td><input type="password" id="pass1"></td>
      </tr>

      <tr>
        <td>確認 (もう1回パスワード打ってね)</td>
        <td><input type="password" id="pass2"></td>
        <td><input type="submit" id="btn" value="submit"></td>
      </tr>
    </table>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
     $(function() {
       var socket = io.connect();

       $('#btn').click(function() {
         var id    = $('#id').val();
         var pass1 = $('#pass1').val();
         var pass2 = $('#pass2').val();

         if(pass1 != pass2){
           $('#pass1').val("");
           $('#pass2').val("");
           alert("Wrong Password!");
         } else {
           socket.json.emit('create user', {
             id: id,
             password: pass1
           });

           socket.on('reply create user', function(data) {
             if(data){
               $('#id').val("");
               $('#pass1').val("");
               $('#pass2').val("");
               alert("既に存在するIDです");
             } else {
               alert("アカウントの作成に成功しました");
             }
           });
         }
       });
     });
    </script>
  </body>
</html>
